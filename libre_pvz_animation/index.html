<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="librePvZ-animation: animation playing for librePvZ for `bevy`."><title>libre_pvz_animation - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-081576b923113409.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="libre_pvz_animation" data-themes="" data-resource-suffix="" data-rustdoc-version="1.79.0 (129f3b996 2024-06-10)" data-channel="1.79.0" data-search-js="search-bf21c90c8c1d92b1.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-e32f0c247825364d.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-20a3ad099b048cf2.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-09095024cf37855e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../libre_pvz_animation/index.html">libre_pvz_animation</a><span class="version">0.1.0</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li></ul></section></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../libre_pvz_animation/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Type ‘S’ or ‘/’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings">Settings</a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">libre_pvz_animation</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../src/libre_pvz_animation/lib.rs.html#19-79">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>librePvZ-animation: animation playing for librePvZ for <a href="../bevy/index.html" title="mod bevy"><code>bevy</code></a>.</p>
<h2 id="librepvz-animation"><a class="doc-anchor" href="#librepvz-animation">§</a>librePvZ Animation</h2>
<blockquote>
<p><strong>Note in advance:</strong> below whenever we point out any drawbacks on the “current approach” or the “design in the RFC”, we actually mean specifically our own understanding and implementation of the RFC. It is perfectly possible (and even likely) that the RFC actually covers the topics below.</p>
</blockquote>
<p>Previously, we mostly copied the design in the RFC <a href="https://github.com/james7132/rfcs/blob/animation-primitives/rfcs/49-animation-primitives.md">Bevy animation primitives</a> (see also the reference implementation <a href="https://github.com/HouraiTeahouse/bevy_prototype_animation"><code>bevy_prototype_animation</code></a>). It turns out the design there does not fit exactly in our use case here:</p>
<ul>
<li><em>Switching animations means rebinding curves.</em> An animation player is attached to some entity, and then every curve in the clip gets bound to its corresponding child entity, so that we can avoid repeatedly performing the search. However, the binding is invalidated by switching the animation clip, which happens very often in PvZ (because plants/zombies need to transition among different states).</li>
<li><em>Animation blending is a non-trivial task.</em> Blending means smoothly transition from one animation to another, playing a mixture of both animations during the transition. However, in current design, before we can play an animation, it needs to be compiled into a clip in advance. Therefore, to blend two animations (each from a specific timestamp), we must generate transient clips again and again (and there are infinitely many of them, since we might want to perform blending at any arbitrary time).</li>
<li><em>We need finer-grained control over the animation playing process.</em> Animation primitives we want here resembles those of the good old ActionScript 2.0 in Adobe Flash, e.g. to play a segment and then stop, or to loop a segment. We share some invariants with Flash animations:
<ul>
<li>Tracks (layers) will always exist, even if we switch from one segment to another;</li>
<li>Animations are based on keyframes, and we have a fixed framerate for animations (this does not imply the animation will be played under the same fixed framerate);</li>
<li>There are only finitely many possible types of components that we want to animate;</li>
</ul>
</li>
</ul>
<p>So we decide to adopt the Flash animation model here. Animations are stored as a series of frames at some pre-determined framerate. Segments are stored as a pair of frame indices (left inclusive, right exclusive). Looping etc. becomes a property of the animation player, without requiring special adjustment of the animation (previously, a looping animation looks correct only if it has the same starting and ending frame).</p>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="clip/index.html" title="mod libre_pvz_animation::clip">clip</a></div><div class="desc docblock-short">Full animation clips.</div></li><li><div class="item-name"><a class="mod" href="curve/index.html" title="mod libre_pvz_animation::curve">curve</a></div><div class="desc docblock-short">Variable curves in animation clips.</div></li><li><div class="item-name"><a class="mod" href="player/index.html" title="mod libre_pvz_animation::player">player</a></div><div class="desc docblock-short">Animation players.</div></li><li><div class="item-name"><a class="mod" href="transform/index.html" title="mod libre_pvz_animation::transform">transform</a></div><div class="desc docblock-short">Dedicated 2D transformation.</div></li></ul><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.AnimationPlugin.html" title="struct libre_pvz_animation::AnimationPlugin">AnimationPlugin</a></div><div class="desc docblock-short">Plugin for animation playing.</div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.AnimationSystem.html" title="enum libre_pvz_animation::AnimationSystem">AnimationSystem</a></div><div class="desc docblock-short">Labels for animation systems.</div></li></ul><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.AnimationExt.html" title="trait libre_pvz_animation::AnimationExt">AnimationExt</a></div><div class="desc docblock-short">Extend <a href="../bevy_app/app/struct.App.html" title="struct bevy_app::app::App"><code>App</code></a> with an <code>register_for_animation</code> API.</div></li></ul></section></div></main></body></html>